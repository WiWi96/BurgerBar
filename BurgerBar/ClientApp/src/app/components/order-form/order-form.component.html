<h1>Your order</h1>
<hr />
<table class="table settings-table">
    <colgroup>
        <col style="width: 60%" />
        <col style="width: 20%" />
        <col style="width: 20%" />
    </colgroup>
    <thead>
        <tr>
            <th>Product</th>
            <th class="text-center">Quantity</th>
            <th class="text-right">Price</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let op of products">
            <td>
                {{op.product?.name}}
                <div *ngIf="op.product?.code" class="d-flex">
                    <p class="product-type text-muted">
                        <small>
                            Burgers
                        </small>
                    </p>
                </div>
                <p class="product-type text-muted">
                    <small>
                        {{op.product?.type?.name}}
                    </small>
                </p>
            </td>
            <td class="text-right">
                {{op.quantity}}
            </td>
            <td class="text-right">{{orderService.getPrice(op)|currency:'PLN':'symbol-narrow':undefined:'pl'}}</td>
        </tr>
    </tbody>
    <tfoot>
        <tr>
            <td></td>
            <td></td>
            <td class="text-right">
                <strong>
                    {{price|currency:'PLN':'symbol-narrow':undefined:'pl'}}
                </strong>
            </td>
        </tr>
    </tfoot>
</table>

<h4>Insert your personal data</h4>
<p class="text-muted">
    Please fill the form to complete the order.
</p>
<hr />
<form [formGroup]="form" (ngSubmit)="save(form)" class="container">
    <ng-container [formGroup]="customerGroup">
        <div class="form-group">
            <label for="firstNameInput">First Name</label>
            <input class="form-control" id="firstNameInput" formControlName="firstName" name="firstName" />
        </div>
        <div class="form-group">
            <label for="lastNameInput">Last Name</label>
            <input class="form-control" id="lastNameInput" formControlName="lastName" name="lastName" />
        </div>
        <ng-container [formGroup]="addressGroup">
            <hr />
            <h6>Address</h6>
            <div class="form-group">
                <label for="streetInput">Street</label>
                <input class="form-control" id="streetInput" formControlName="street" name="street" />
            </div>
            <div class="form-row">
                <div class="form-group col-6">
                    <label for="houseNoInput">House Number</label>
                    <input class="form-control" id="houseNoInput" formControlName="houseNumber" name="houseNumber" />
                </div>
                <div class="form-group col-6">
                    <label for="apartmentNumberInput">Apartment Number</label>
                    <input class="form-control" id="apartmentNumberInput" formControlName="apartmentNumber" name="apartmentNumber" />
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-4">
                    <label for="postalCodeInput">Zip code</label>
                    <input class="form-control" id="postalCodeInput" formControlName="postalCode" name="postalCode" />
                </div>
                <div class="form-group col-8">
                    <label for="townInput">Town</label>
                    <input class="form-control" id="townInput" formControlName="town" name="town" />
                </div>
            </div>
        </ng-container>
        <hr />
        <h6>Contact</h6>
        <div class="form-group">
            <label for="phoneInput">Phone Number</label>
            <input class="form-control" id="phoneInput" formControlName="phoneNumber" name="phoneNumber" type="tel" />
        </div>
        <div class="form-group">
            <label for="emailInput">E-mail</label>
            <input class="form-control" id="emailInput" formControlName="email" name="email" type="email" />
        </div>
    </ng-container>
    <hr />
    <h6>Delivery and payment</h6>
    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="deliverySelect">Delivery type</label>
            <select class="form-control" id="deliverySelect" formControlName="deliveryType" name="deliveryType" (change)="calculateFullPrice()">
                <option *ngFor="let dt of deliveryTypes" [ngValue]="dt">
                    {{dt.name}} ({{dt.price|currency:'PLN':'symbol-narrow':undefined:'pl'}})
                </option>
            </select>
        </div>
        <div class="form-group col-md-6">
            <label for="paymentSelect">Payment type</label>
            <select class="form-control" id="paymentSelect" formControlName="paymentType" name="paymentType" (change)="calculateFullPrice()">
                <option *ngFor="let pt of paymentTypes" [ngValue]="pt">
                    {{pt.name}} ({{pt.price|currency:'PLN':'symbol-narrow':undefined:'pl'}})
                </option>
            </select>
        </div>
    </div>
    <hr />
    <div class="float-md-right text-right">
        <p>Overall price:</p>
        <h3>{{fullPrice|currency:'PLN':'symbol-narrow':undefined:'pl'}}</h3>
        <hr />
        <button class="btn btn-primary btn-lg" type="submit" [disabled]="!form.valid||formSubmitted">Place the order</button>
    </div>
    <button class="btn" [routerLink]="['/cart']">Go back to cart</button>
</form>
